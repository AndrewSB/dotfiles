# Arguments: takes a project alias

_fios_aliases=(expenses_hack cvs_components)

complete -W "$_fios_aliases" fios

function fios() {
	if [ $# -ne 1 ]; then
		echo "need an argument to build"
		return 1
	fi

	local SHOULD_POP=false
	if ! [[ ${PWD} -eq "${HOME}/fbsource/fbobjc"* ]]; then # if the pwd is a child of ~/fbsource/fbobjc
		echo "should pop true"
		SHOULD_POP=true
		pushd ~/fbsource/fbobjc
	fi

	case "$1" in
		cvs_components)
			buck project //Libraries/Libra/CVSUIKit:CVSComponentLibraryApp && open ~/fbsource/fbobjc/Libraries/Libra/CVSUIKit/CVSComponentLibraryApp.xcworkspace
			;;
		expenses_hack)
			buck project //Apps/Internal/ExpensesHack:ExpensesHack && open ~/fbsource/fbobjc/Apps/Internal/ExpensesHack/ExpensesHack.xcworkspace
			;;
		*)
			echo "fios: you need to specify one alias to build from ${_fios_aliases}[*]"
			popd
			return 1
			;;
	esac

	if $SHOULD_POP ; then
		popd
	fi
}
